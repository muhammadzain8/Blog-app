<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <!-- <link
      rel="stylesheet"
      href="/fontawesome-free-5.12.1-web/css/all.css"
      crossorigin="anonymous"
    /> -->
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"
      integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
      integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB"
      crossorigin="anonymous"
    />
    <title>Blogen App - Profile</title>
  </head>

  <body>
    <button class="btn btn-danger d-none" id="btn1">Danger</button>
    <button class="btn btn-warning d-none" id="btn2">Warning</button>
    <button class="btn btn-primary d-none" id="btn3">Primary</button>
    <%- include ('partials/nav') -%>
    <!-- HEADER -->
    <header id="main-header" class="py-2 bg-primary text-white">
      <div class="container">
        <div class="row">
          <div class="col-md-6">
            <h1><i class="fas fa-user"></i> Edit Profile</h1>
          </div>
        </div>
      </div>
    </header>

    <!-- ACTIONS -->
    <section id="actions" class="py-4 mb-4 bg-light">
      <div class="container">
        <div class="row">
          <div class="col-md-3">
            <a href="/" class="btn btn-primary pl-0 ml-0 btn-block">
              <i class="fas fa-arrow-left ml-0"></i> Back to Dashboard
            </a>
          </div>
          <div class="col-md-3">
            <!-- Button trigger modal -->

            <a
              href="#changePopup"
              data-toggle="modal"
              class="btn btn-success btn-block"
              data-target="#passModal"
              id="togglePasswordModal"
            >
              <i class="fas fa-lock"></i> Change Password
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- PROFILE -->
    <section id="profile">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <div class="card">
              <div class="card-header">
                <h4>Edit Profile</h4>
              </div>
              <div class="card-body">
                <form>
                  <% if(message.length > 0) { %>
                  <div
                    class="alert alert-danger alert-dismissible fade show"
                    role="alert"
                  >
                    <button
                      type="button"
                      class="close"
                      data-dismiss="alert"
                      aria-label="Close"
                    >
                      <span aria-hidden="true">&times;</span>
                      <span class="sr-only">Close</span>
                    </button>
                    <strong> <%= message %>!</strong>
                  </div>
                  <% } %> <% if(success.length > 0) { %>
                  <div
                    class="alert alert-success alert-dismissible fade show"
                    role="alert"
                  >
                    <button
                      type="button"
                      class="close"
                      data-dismiss="alert"
                      aria-label="Close"
                    >
                      <span aria-hidden="true">&times;</span>
                      <span class="sr-only">Close</span>
                    </button>
                    <strong> <%= success %>!</strong>
                  </div>
                  <% } %>

                  <div class="form-group">
                    <label for="name">Name</label>
                    <input
                      type="text"
                      class="form-control"
                      value="<%= user.name %>"
                      id="name"
                    />
                    <small class="invalid-feedback">
                      Invalid or Empty Name
                    </small>
                  </div>
                  <div class="form-group">
                    <label for="email">Email</label>
                    <input
                      id="email"
                      type="email"
                      class="form-control"
                      value="<%= user.email %>"
                    />
                    <small class="invalid-feedback">
                      Invalid or Empty Email
                    </small>
                  </div>
                  <div class="form-group">
                    <label for="bio">Bio</label>
                    <textarea
                      class="form-control"
                      id="bio"
                      name="editor1"
                      rows="8"
                    >
<%= user.bio %>
                  </textarea
                    >
                    <small class="invalid-feedback">
                      Invalid or Empty Bio
                    </small>
                  </div>
                  <button
                    class="btn btn-primary btn-block"
                    type="submit"
                    id="submitProfile"
                  >
                    <i class="fas fa-check pr-2"></i>
                    Save Changes
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- FOOTER -->
    <%- include ('partials/footer') -%>

    <!-- Change Password Modal -->

    <!-- Modal -->
    <div
      class="modal fade"
      id="passModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="modalTitle"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header bg-success text-center text-white">
            <h5 class="modal-title" id="modalTitle">Change Password</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form action="/resetPassword" method="patch">
              <% if(passError.length > 0) { %>
              <div
                class="alert alert-danger alert-dismissible fade show"
                role="alert"
                id="passAlert"
              >
                <button
                  type="button"
                  class="close"
                  data-dismiss="alert"
                  aria-label="Close"
                >
                  <span aria-hidden="true">&times;</span>
                  <span class="sr-only">Close</span>
                </button>
                <strong> <%= passError %>!</strong>
              </div>
              <% } %>

              <div class="form-group">
                <label for="password1">Current Password</label>
                <input class="form-control" id="password1" type="password" />
                <small class="invalid-feedback">
                  This fields must NOT be less than 8 characters
                </small>
              </div>
              <hr />
              <div class="form-group">
                <label for="password2">New Password</label>
                <input class="form-control" id="password2" type="password" />
                <small class="invalid-feedback">
                  This fields must NOT be less than 8 characters
                </small>
              </div>

              <div class="form-group">
                <label for="password3">Cofirm New Password</label>
                <input class="form-control" id="password3" type="password" />
                <small class="invalid-feedback">
                  This fields must NOT be less than 8 characters
                </small>
                <small class="invalid-feedback" id="confirmFeedback">
                  Confirm Password must be equal to New Password
                </small>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="submit" id="changeBtn" class="btn btn-warning">
              Change
            </button>
          </div>
        </div>
      </div>
    </div>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"
      integrity="sha256-T/f7Sju1ZfNNfBh7skWn0idlCBcI3RwdLSS4/I7NQKQ="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://code.jquery.com/jquery-3.3.1.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
      integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"
      integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
      crossorigin="anonymous"
    ></script>

    <script src="/javascripts/saveProfile.js"></script>
    <script src="/javascripts/updatePassword.js"></script>
  </body>
</html>
